<!-- MarkdownTOC  levels="2" autolink="true" uri_encoding="false" -->

- [1. Начало](#1-Начало)
- [2. Работа с репозиториями](#2-Работа-с-репозиториями)
- [3. Работа через ssh](#3-Работа-через-ssh)
- [4. Соглашения тексту коммитов](#4-Соглашения-тексту-коммитов)
- [5. Настройка аутентификации через ssh в Win \(через Cmder\)](#5-Настройка-аутентификации-через-ssh-в-win-через-cmder)
- [99. Разное](#99-Разное)

<!-- /MarkdownTOC -->

## 1. Начало

Создание репозитория

    git init

Скачивание существующего

    git clone https://github.com/....git

## 2. Работа с репозиториями

**Просмотр сведений о репозитории** 
    
    git remote -v
    git remote show origin

**Привязка к удаленному репозиторию**
    
    git remote add <Имя> <Адрес>

    git remote add origin https://github.com/someuser/test.git
 
**Получение данных из репозитория** (без изменения локальных данных, нужен merge)

    git fetch origin

**Получение и слияние данных** по отслеживаемой ветви (при клонировании отслеживаемая автоматически настраивается на *main*)

    git pull

**Отправка изменений в репозиторий**

    git push origin main

**Сравнение веток** (например локальной и на удаленном репозитории)

смотрим ветки `git branch -a`

получаем данные из репозитория `git fetch origin`

смотрим различия `git diff main origin/main`

или кратко `git diff main origin/main --stat`

сливаем данные из репозитория `git pull` если надо

## 3. Работа через ssh

[docs](https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh)

1. Проверить есть ли готовые ключи `ls -al ~/.ssh `
2. Сгенерировать новую пару `ssh-keygen -t ed25519 -C "your_email@`
3. Добавить приватный ключ в ssh-агент `ssh-add ~/.ssh/id_ed25519`
4. Добавить публичный в настройки гита (скопировать содержимое публичного)
5. Репозитории клонировать через `git@github.com:....`

Репозиторий можно переключить на работу через ssh: [c HTTPS на SSH](https://docs.github.com/en/github/using-git/changing-a-remotes-url#switching-remote-urls-from-https-to-ssh)

    git remote set-url origin git@github.com:USERNAME/REPOSITORY.git

## 4. Соглашения тексту коммитов

[habr](https://habr.com/ru/company/yandex/blog/431432/)

Коммит в общем случае состоит из заголовка, тела и подвала. Заголовок описывает что делает коммит. Тело более подробно раскрывает почему и как. В подвале обычно хранится мета-информация: ссылки на задачи, issue и т. п.

**Правила**:

1. Отделять заголовок от тела пустой строкой. Заголовок используется различными утилитами (как тема письма, вывод в лог `git log --oneline` и т. п.)
2. Ограничить заголовок до 50 символов. Если трудно уложиться - возможно коммит включает слишком много действий, и его следует разделить (атомарность коммитов)
3. Начинать заголовок с большой буквы.
4. Не ставить точку в заголовке.
5. Использовать повелительное наклонение (imperative mood) в заголовке : `Add ..`, `Fix ..` и т. п. Описание как бы является продолжением фразы If applied, this commit will .., что отражает изменения/результат коммита. Это как перечень инструкций по продвижению от исходного состояния к текущему через применение коммитов. Для русского языка можно использовать инфинитив (Добавить..), или пассивный залог (Добавлена..), или указание на свершившийся факт (Добавил..). Возможно пассивный залог лучше встраивается в схему: Этим коммитом будет .. (добавлено например).
6. Форматировать тело коммита в 72 символа (переносить на новые строки, если не влазит). Это улучшит отображение. 
7. Использовать тело для описания что и почему, а не как.

Есть **более строгие правила** с жесткой структурой:

[См. здесь](https://www.conventionalcommits.org/)

    <type>(<scope>): <subject>
    
    <body>
    
    <footer>

Типы коммита жестко заданы: feat, fix и т. п. Область - опциональна, описывает к чему применяется.

Есть разные инструменты для генерации / проверки текста коммитов. Кроме унификации позволяют автоматически генерировать change log. 

## 5. Настройка аутентификации через ssh в Win (через Cmder)

* сгенерировать ключ (любой способ: Putty, ssh-keygen через Cmder)
* добавить ключ на GitHub [docs](https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh)
* запустить **ssh-agent** в Cmder
    - `eval $(ssh-agent)`
    - проверить наличие ключей можно `ssh-add -l`
    - если дает ошибку "Could not open a connection to your authentication agent" см. [stackover](https://stackoverflow.com/questions/17846529/could-not-open-a-connection-to-your-authentication-agent/10077302#10077302)
* добавить ключ в агент `ssh-add <путь к приватному ключу>`
* можно работать через ssh:
    - перевести репозиторий на работу через ssh ` git remote set-url origin git@github.com:USERNAME/REPOSITORY.git`
    - или клонировать через `git@github...` 

## 99. Разное

**Путь, где установлен git**

    git --exec-path

**Переключение вывода не латинских символов в путях**

    git config --global core.quotepath false

Тогда вместо например `new file: "src/Ext/\237\321\321\200\320\270\..` будет кириллица.

**Настройка текстового редактора**

Нужен флаг `-w`, чтобы git ждал окончания ввода от Sublime:

    git config --global core.editor "'c:/program files/../sublimetext.exe' -w"

Для других редакторов см. [attlassian docs](https://www.atlassian.com/ru/git/tutorials/setting-up-a-repository/git-config)
